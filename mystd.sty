\ProvidesPackage{mystd}

\usepackage{mathtools,amssymb,amsthm,amsfonts,amscd,amsmath,mathrsfs}
\usepackage[svgnames,dvipsnames]{xcolor}

\usepackage[margin=11em,top=7em,bottom=7em]{geometry}

\definecolor{AccColor1}{HTML}{C41E3A}     %#C41E3A
\definecolor{AccColor2}{HTML}{233F8D}     %#233F8D
\definecolor{AccColor3}{HTML}{D19820}     %#D19820
\definecolor{AccColor4}{HTML}{148670}     %#148670

\colorlet{ColAccGood}{AccColor4}          %#148670
\definecolor{ColAccBad}{HTML}{D14B20}     %#D14B20

\colorlet{MainColor}{AccColor1}           %#C41E3A
\definecolor{LinkColor1}{HTML}{329B71}    %#329B71
\colorlet{LinkColor2}{AccColor2}          %#233F8D

\definecolor{BoxColor1}{HTML}{081D56}     %#081D56
\definecolor{BoxColor2}{HTML}{A8760F}     %#A8760F

\usepackage[colorlinks=true]{hyperref}
\hypersetup{urlcolor=LinkColor1,linkcolor=LinkColor2,citecolor=LinkColor2}
\usepackage[nameinlink]{cleveref}
\usepackage{thmtools}
\usepackage{relsize}
\usepackage{yhmath}  % for wideparen
\usepackage{esint}  % better integrals
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usepgflibrary{patterns} 
\usetikzlibrary{patterns}
\usepackage{tikz-3dplot}
\usepackage{tkz-euclide}
\usetikzlibrary{math,shapes.geometric,calc,positioning,fit,decorations.markings}
\tikzset{>=latex}
\usepackage{nicematrix}
\NiceMatrixOptions{
    custom-line={letter=I, tikz=densely dashed, total-width=\pgflinewidth},
    custom-line={letter=S, tikz=solid, total-width=\pgflinewidth}
}
\usepackage{booktabs}
\usepackage{nomencl}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}


\newif\ifstdthm\stdthmfalse
\newif\ifstdcolorsec\stdcolorsecfalse
\newif\ifstdmonofont\stdmonofontfalse

\DeclareOption{pretty}{\stdthmtrue\stdcolorsectrue}

\DeclareOption{thm}{\stdthmtrue}
\DeclareOption{nothm}{\stdthmfalse}
\DeclareOption{colorsec}{\stdcolorsectrue}
\DeclareOption{nocolorsec}{\stdcolorsecfalse}
\DeclareOption{monofont}{\stdmonofonttrue}

\ProcessOptions\relax


\usepackage{fontspec}
\usepackage{unicode-math}
\defaultfontfeatures[CMU Serif]{
    UprightFont=cmunrm,
    BoldFont=cmunbx,
    ItalicFont=cmunti,
    BoldItalicFont=cmunbi,
    Extension=.otf,
    Ligatures=TeX
}
\ifstdmonofont
    \setmonofont{JetBrainsMono}[
        Path=./fonts/,
        Scale=0.85,
        Extension=.ttf,
        UprightFont=*-Regular,
        BoldFont=*-Bold,
        ItalicFont=*-Italic,
        BoldItalicFont=*-BoldItalic
    ]
\fi
\usepackage[french]{babel}

%  ----------  SHORT AND USEFUL STUFF  ----------  %

\let\ker\relax
\let\Im\relax
\DeclareMathOperator{\Ims}{Im}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\ker}{ker}
\DeclareMathOperator{\N}{\mathbb N}
\DeclareMathOperator{\Z}{\mathbb Z}
\DeclareMathOperator{\Q}{\mathbb Q}
\DeclareMathOperator{\R}{\mathbb R}
\DeclareMathOperator{\Rpe}{\mathbb R_+^*}
\DeclareMathOperator{\C}{\mathbb C}
\DeclareMathOperator{\K}{\mathbb K}
\DeclareMathOperator{\gl}{GL}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\rg}{rg}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\dd}{d\hskip-1.5pt}
\DeclareMathOperator{\Card}{Card}
\DeclareMathOperator{\Vect}{Vect}
\DeclareMathOperator{\Fr}{Fr}
\DeclareMathOperator{\Adh}{Adh}
\DeclareMathOperator{\DM}{DM}
\DeclareMathOperator{\MD}{MD}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\cd}{cd}


\newcommand{\norm}[1]{\left\lVert #1\right\rVert}
\newcommand{\inl}[2]{[\![#1,#2]\!]}
\newcommand{\tnorm}[1]{\left|\hskip-.12em\lVert #1\rVert\hskip-.12em\right|}

%  ----------------------------------------------  %

\renewcommand{\thepart}{}
\renewcommand{\partname}{}

\ifstdthm
    \usepackage[framemethod=TikZ]{mdframed}
    \declaretheoremstyle[
        headfont=\sffamily\bfseries\color{BoxColor1},
        %mdframed={style=mdbluebox},
        %headpunct={\\[3pt]},
        postheadspace={3pt},
        spacebelow={5pt}
    ]{thmbluebox}
    \declaretheoremstyle[
        headfont=\sffamily\itshape\color{BoxColor1},
        %mdframed={style=mdbluebox},
        %headpunct={\\[3pt]},
        postheadspace={3pt},
        spacebelow={5pt}
    ]{thmitbluebox}
\else
    \declaretheoremstyle[headfont=\bfseries,bodyfont=\normalfont,spaceabove=\topsep,spacebelow=\topsep]{thmbluebox}
\fi

\theoremstyle{definition}

\declaretheorem[style=thmbluebox,name=Exercice CCP,numbered=no]{ccp}
\declaretheorem[style=thmbluebox,name=Question de cours,numbered=no]{qc}
\declaretheorem[style=thmbluebox,name=Exercice,numberwithin=subsection]{exo}
\declaretheorem[style=thmbluebox,name=Exercice,numbered=no]{exo*}
\declaretheorem[style=thmbluebox,name=Théorème,numbered=no]{thm}

\theoremstyle{remark}
\declaretheorem[style=thmitbluebox,name=Remarques,numbered=no]{remarks}

\renewcommand{\qedsymbol}{\ensuremath{\blacksquare}}
\renewenvironment{proof}[1][Éléments de réponse]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item[\hskip\labelsep
        \color{BoxColor1}\sffamily\itshape
    #1\@addpunct{.}]\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}


\ifstdcolorsec
    \@ifundefined{chapter}{}{
        \addtokomafont{partprefix}{\rmfamily}
        \renewcommand*{\partformat}{\color{MainColor}
            \scalebox{2.5}{\thepart}\enlargethispage{2em}}
        \addtokomafont{chapterprefix}{\raggedleft}
        \RedeclareSectionCommand[beforeskip=0.5em]{chapter}
        \renewcommand*{\chapterformat}{\mbox{%
            \scalebox{1.5}{\chapappifchapterprefix{\nobreakspace}}%
            \scalebox{2.718}{\color{MainColor}\thechapter}\enskip}}
    }
    \renewcommand*{\sectionformat}%
        {\color{MainColor}\S\thesection\enskip}
    \renewcommand*{\subsectionformat}%
        {\color{MainColor}\S\thesubsection\enskip}
    \renewcommand*{\subsubsectionformat}%
        {\color{MainColor}\S\thesubsubsection\enskip}
    \KOMAoptions{numbers=noenddot}
\fi

\usepackage{listings}
\usepackage{textcomp}
\lstset{
    basicstyle=\footnotesize\ttfamily,
    numberstyle=\ttfamily,
    numbers=left,
    numbersep=5pt,
    numberstyle=\tiny,
    keywordstyle=\bfseries,
    showstringspaces=false,
    tabsize=4,
    frame=single,
    keywordstyle=\bfseries\color{blue},
    commentstyle=\color{green!70!black},
    identifierstyle=\color{green!20!black},
    stringstyle=\color{orange},
    breaklines=true,
    breakatwhitespace=true,
    frame=none,
    texcl=true    % for unicode and math in the comments
}
\usepackage[shortlabels]{enumitem}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{microtype}
\usepackage[color=ColAccBad!70]{todonotes}

\addtokomafont{subtitle}{\Large}
\setkomafont{author}{\Large\slshape}
\setkomafont{date}{\small}
\setkomafont{caption}{\small}
\providecommand{\thetitle}{\@title}
\providecommand{\theauthor}{\@author}
\providecommand{\thedate}{\@date}

\expandafter\def\expandafter\normalsize\expandafter{%
    \normalsize%
    \setlength\abovedisplayskip{3pt}%
    \setlength\belowdisplayskip{3pt}%
    \setlength\abovedisplayshortskip{2pt}%
    \setlength\belowdisplayshortskip{2pt}%
}